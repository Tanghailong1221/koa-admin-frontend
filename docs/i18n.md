# å›½é™…åŒ–ç³»ç»Ÿä½¿ç”¨æŒ‡å—

æœ¬é¡¹ç›®å®ç°äº†ä¸€ä¸ªè½»é‡çº§çš„å›½é™…åŒ–ç³»ç»Ÿï¼Œæ”¯æŒä¸­æ–‡å’Œè‹±æ–‡ä¸¤ç§è¯­è¨€ã€‚

## åŠŸèƒ½ç‰¹æ€§

- âœ… æ”¯æŒä¸­æ–‡ï¼ˆzh-CNï¼‰å’Œè‹±æ–‡ï¼ˆen-USï¼‰
- âœ… ç¿»è¯‘å‡½æ•°æ”¯æŒå‚æ•°æ›¿æ¢
- âœ… è‡ªåŠ¨ä»æµè§ˆå™¨è·å–é¦–é€‰è¯­è¨€
- âœ… è¯­è¨€è®¾ç½®æŒä¹…åŒ–åˆ° localStorage
- âœ… é›†æˆ Element Plus locale
- âœ… å“åº”å¼è¯­è¨€åˆ‡æ¢
- âœ… ç±»å‹å®‰å…¨çš„ç¿»è¯‘é”®
- âœ… æ™ºèƒ½å›é€€æœºåˆ¶ï¼ˆæ‰¾ä¸åˆ°ç¿»è¯‘æ—¶ä½¿ç”¨é»˜è®¤è¯­è¨€ï¼‰
- âœ… ç¼ºå¤±ç¿»è¯‘é”®è®°å½•å’Œè­¦å‘Šï¼ˆå¼€å‘ç¯å¢ƒï¼‰
- âœ… æ‡’åŠ è½½è¯­è¨€æ–‡ä»¶ï¼ˆæŒ‰éœ€åŠ è½½ï¼Œå‡å°‘åˆå§‹åŒ…å¤§å°ï¼‰
- âœ… è¯­è¨€æ–‡ä»¶ç¼“å­˜ç®¡ç†

## åŸºç¡€ç”¨æ³•

### 1. åœ¨ç»„ä»¶ä¸­ä½¿ç”¨

```vue
<template>
  <div>
    <h1>{{ t('common.action.add') }}</h1>
    <p>{{ t('common.message.success') }}</p>
  </div>
</template>

<script setup lang="ts">
import { useI18n } from '@/composables'

const { t } = useI18n()
</script>
```

### 2. å‚æ•°æ›¿æ¢

```vue
<template>
  <div>
    <!-- ä¸­æ–‡: å…± 100 æ¡ -->
    <!-- English: Total 100 items -->
    <p>{{ t('common.table.total', { total: 100 }) }}</p>
    
    <!-- ä¸­æ–‡: å·²é€‰ 5 æ¡ -->
    <!-- English: 5 selected -->
    <p>{{ t('common.table.selected', { count: 5 }) }}</p>
  </div>
</template>

<script setup lang="ts">
import { useI18n } from '@/composables'

const { t } = useI18n()
</script>
```

### 3. è¯­è¨€åˆ‡æ¢

```vue
<template>
  <div>
    <el-button @click="changeLocale('zh-CN')">ä¸­æ–‡</el-button>
    <el-button @click="changeLocale('en-US')">English</el-button>
    
    <p>å½“å‰è¯­è¨€: {{ currentLocaleInfo?.name }}</p>
  </div>
</template>

<script setup lang="ts">
import { useI18n } from '@/composables'

const { locale, currentLocaleInfo, changeLocale } = useI18n()
</script>
```

### 4. Element Plus ç»„ä»¶å›½é™…åŒ–

```vue
<template>
  <el-config-provider :locale="elementLocale">
    <el-date-picker
      v-model="date"
      type="date"
      placeholder="é€‰æ‹©æ—¥æœŸ"
    />
    
    <el-pagination
      :total="100"
      layout="total, prev, pager, next"
    />
  </el-config-provider>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import { useI18n } from '@/composables'

const { elementLocale } = useI18n()
const date = ref<Date>()
</script>
```

## é«˜çº§åŠŸèƒ½

### 1. æ‡’åŠ è½½è¯­è¨€æ–‡ä»¶ï¼ˆæ¨èï¼‰

æ‡’åŠ è½½å¯ä»¥å‡å°‘åˆå§‹åŒ…å¤§å°ï¼Œæå‡é¦–å±åŠ è½½é€Ÿåº¦ã€‚

```typescript
import { useI18n } from '@/composables'

const { changeLocaleAsync, loading, isLoaded } = useI18n()

// å¼‚æ­¥åˆ‡æ¢è¯­è¨€ï¼ˆè‡ªåŠ¨åŠ è½½è¯­è¨€æ–‡ä»¶ï¼‰
async function switchLanguage(locale: 'zh-CN' | 'en-US') {
  try {
    await changeLocaleAsync(locale)
    console.log('è¯­è¨€åˆ‡æ¢æˆåŠŸ')
  } catch (error) {
    console.error('è¯­è¨€åˆ‡æ¢å¤±è´¥:', error)
  }
}

// æ£€æŸ¥è¯­è¨€æ–‡ä»¶æ˜¯å¦å·²åŠ è½½
if (!isLoaded('en-US')) {
  console.log('è‹±æ–‡è¯­è¨€æ–‡ä»¶æœªåŠ è½½')
}
```

### 2. é¢„åŠ è½½è¯­è¨€æ–‡ä»¶

åœ¨åº”ç”¨å¯åŠ¨æ—¶é¢„åŠ è½½æ‰€æœ‰è¯­è¨€æ–‡ä»¶ï¼Œé¿å…åˆ‡æ¢æ—¶çš„å»¶è¿Ÿã€‚

```typescript
import { useI18n } from '@/composables'

const { preload } = useI18n()

// é¢„åŠ è½½æ‰€æœ‰è¯­è¨€æ–‡ä»¶
async function preloadAllLanguages() {
  await preload(['zh-CN', 'en-US'])
  console.log('æ‰€æœ‰è¯­è¨€æ–‡ä»¶å·²é¢„åŠ è½½')
}

// åœ¨åº”ç”¨å¯åŠ¨æ—¶é¢„åŠ è½½
preloadAllLanguages()
```

### 3. æ£€æŸ¥ç¿»è¯‘é”®æ˜¯å¦å­˜åœ¨

åœ¨ä½¿ç”¨ç¿»è¯‘é”®ä¹‹å‰æ£€æŸ¥æ˜¯å¦å­˜åœ¨ï¼Œé¿å…æ˜¾ç¤ºé”®åã€‚

```typescript
import { useI18n } from '@/composables'

const { has, t } = useI18n()

// æ£€æŸ¥ç¿»è¯‘é”®æ˜¯å¦å­˜åœ¨
if (has('common.action.add')) {
  console.log(t('common.action.add'))
} else {
  console.log('ç¿»è¯‘é”®ä¸å­˜åœ¨')
}

// æ£€æŸ¥ç‰¹å®šè¯­è¨€çš„ç¿»è¯‘é”®
if (has('common.action.add', 'en-US')) {
  console.log('è‹±æ–‡ç¿»è¯‘é”®å­˜åœ¨')
}
```

### 4. æŸ¥çœ‹ç¼ºå¤±çš„ç¿»è¯‘é”®ï¼ˆå¼€å‘ç¯å¢ƒï¼‰

å¼€å‘ç¯å¢ƒä¼šè‡ªåŠ¨è®°å½•ç¼ºå¤±çš„ç¿»è¯‘é”®ï¼Œæ–¹ä¾¿è¡¥å……ç¿»è¯‘ã€‚

```typescript
import { useI18n } from '@/composables'

const { missingKeys, clearMissing } = useI18n()

// è·å–ç¼ºå¤±çš„ç¿»è¯‘é”®
console.log('ç¼ºå¤±çš„ç¿»è¯‘é”®:', missingKeys.value)
// è¾“å‡º: ['en-US:common.action.custom', 'zh-CN:user.status.unknown']

// æ¸…é™¤ç¼ºå¤±çš„ç¿»è¯‘é”®è®°å½•
clearMissing()
```

### 5. æ¸…é™¤è¯­è¨€æ–‡ä»¶ç¼“å­˜

åœ¨æŸäº›æƒ…å†µä¸‹ï¼ˆå¦‚è¯­è¨€æ–‡ä»¶æ›´æ–°ï¼‰ï¼Œéœ€è¦æ¸…é™¤ç¼“å­˜é‡æ–°åŠ è½½ã€‚

```typescript
import { useI18n } from '@/composables'

const { clearCache, loadedLocales } = useI18n()

// æŸ¥çœ‹å·²åŠ è½½çš„è¯­è¨€
console.log('å·²åŠ è½½çš„è¯­è¨€:', loadedLocales.value)

// æ¸…é™¤ç‰¹å®šè¯­è¨€çš„ç¼“å­˜
clearCache('en-US')

// æ¸…é™¤æ‰€æœ‰è¯­è¨€çš„ç¼“å­˜
clearCache()
```

## è¯­è¨€æ–‡ä»¶ç»“æ„

```
src/locales/
â”œâ”€â”€ index.ts                 # å›½é™…åŒ–æ ¸å¿ƒ
â”œâ”€â”€ element-plus.ts          # Element Plus locale é›†æˆ
â”œâ”€â”€ zh-CN/                   # ä¸­æ–‡è¯­è¨€åŒ…
â”‚   â”œâ”€â”€ index.ts
â”‚   â”œâ”€â”€ common.ts            # é€šç”¨ç¿»è¯‘
â”‚   â”œâ”€â”€ user.ts              # ç”¨æˆ·ç›¸å…³
â”‚   â”œâ”€â”€ menu.ts              # èœå•ç¿»è¯‘
â”‚   â”œâ”€â”€ error.ts             # é”™è¯¯ä¿¡æ¯
â”‚   â””â”€â”€ validation.ts        # è¡¨å•éªŒè¯
â””â”€â”€ en-US/                   # è‹±æ–‡è¯­è¨€åŒ…
    â”œâ”€â”€ index.ts
    â”œâ”€â”€ common.ts
    â”œâ”€â”€ user.ts
    â”œâ”€â”€ menu.ts
    â”œâ”€â”€ error.ts
    â””â”€â”€ validation.ts
```

## æ·»åŠ æ–°çš„ç¿»è¯‘

### 1. åœ¨è¯­è¨€æ–‡ä»¶ä¸­æ·»åŠ ç¿»è¯‘

```typescript
// src/locales/zh-CN/common.ts
export default {
  action: {
    add: 'æ–°å¢',
    edit: 'ç¼–è¾‘',
    // æ·»åŠ æ–°çš„ç¿»è¯‘
    export: 'å¯¼å‡º'
  }
}

// src/locales/en-US/common.ts
export default {
  action: {
    add: 'Add',
    edit: 'Edit',
    // æ·»åŠ å¯¹åº”çš„è‹±æ–‡ç¿»è¯‘
    export: 'Export'
  }
}
```

### 2. åœ¨ç»„ä»¶ä¸­ä½¿ç”¨

```vue
<template>
  <el-button>{{ t('common.action.export') }}</el-button>
</template>
```

## æ·»åŠ æ–°çš„è¯­è¨€

### 1. åˆ›å»ºè¯­è¨€æ–‡ä»¶

```typescript
// src/locales/ja-JP/index.ts
import common from './common'
import user from './user'
// ... å…¶ä»–æ¨¡å—

export default {
  common,
  user,
  // ...
}
```

### 2. æ›´æ–°è¯­è¨€é…ç½®

```typescript
// src/locales/index.ts
import jaJP from './ja-JP'

export const SUPPORT_LOCALES = ['zh-CN', 'en-US', 'ja-JP'] as const

const messages: Record<SupportLocale, any> = {
  'zh-CN': zhCN,
  'en-US': enUS,
  'ja-JP': jaJP
}

export const LOCALE_LIST: LocaleInfo[] = [
  { locale: 'zh-CN', name: 'ç®€ä½“ä¸­æ–‡', icon: 'ğŸ‡¨ğŸ‡³' },
  { locale: 'en-US', name: 'English', icon: 'ğŸ‡ºğŸ‡¸' },
  { locale: 'ja-JP', name: 'æ—¥æœ¬èª', icon: 'ğŸ‡¯ğŸ‡µ' }
]
```

### 3. æ·»åŠ  Element Plus locale

```typescript
// src/locales/element-plus.ts
import ja from 'element-plus/es/locale/lang/ja'

const elementLocales: Record<SupportLocale, Language> = {
  'zh-CN': zhCn,
  'en-US': en,
  'ja-JP': ja
}
```

## API å‚è€ƒ

### useI18n()

è¿”å›å›½é™…åŒ–ç›¸å…³çš„æ–¹æ³•å’ŒçŠ¶æ€ã€‚

```typescript
const {
  locale,              // å½“å‰è¯­è¨€ï¼ˆå“åº”å¼ï¼‰
  localeList,          // è¯­è¨€åˆ—è¡¨
  currentLocaleInfo,   // å½“å‰è¯­è¨€ä¿¡æ¯
  elementLocale,       // Element Plus locale
  t,                   // ç¿»è¯‘å‡½æ•°
  changeLocale         // åˆ‡æ¢è¯­è¨€
} = useI18n()
```

#### locale

- ç±»å‹: `ComputedRef<SupportLocale>`
- è¯´æ˜: å½“å‰è¯­è¨€ï¼Œå“åº”å¼

#### localeList

- ç±»å‹: `ComputedRef<LocaleInfo[]>`
- è¯´æ˜: æ”¯æŒçš„è¯­è¨€åˆ—è¡¨

#### currentLocaleInfo

- ç±»å‹: `ComputedRef<LocaleInfo | undefined>`
- è¯´æ˜: å½“å‰è¯­è¨€ä¿¡æ¯

#### elementLocale

- ç±»å‹: `ComputedRef<Language>`
- è¯´æ˜: Element Plus è¯­è¨€åŒ…

#### t(key, params?)

- å‚æ•°:
  - `key`: ç¿»è¯‘é”®ï¼Œå¦‚ `'common.action.add'`
  - `params`: å¯é€‰ï¼Œå‚æ•°å¯¹è±¡ï¼Œå¦‚ `{ total: 100 }`
- è¿”å›: `string`
- è¯´æ˜: ç¿»è¯‘å‡½æ•°ï¼Œæ”¯æŒå‚æ•°æ›¿æ¢

#### changeLocale(locale)

- å‚æ•°:
  - `locale`: ç›®æ ‡è¯­è¨€ï¼Œå¦‚ `'zh-CN'` æˆ– `'en-US'`
- è¿”å›: `void`
- è¯´æ˜: åˆ‡æ¢è¯­è¨€

## ç¿»è¯‘é”®å‘½åè§„èŒƒ

### 1. æ¨¡å—åŒ–

æŒ‰åŠŸèƒ½æ¨¡å—ç»„ç»‡ç¿»è¯‘é”®ï¼š

```
common.action.add        # é€šç”¨ > æ“ä½œ > æ–°å¢
user.info.username       # ç”¨æˆ· > ä¿¡æ¯ > ç”¨æˆ·å
menu.dashboard           # èœå• > ä»ªè¡¨ç›˜
error.http.404           # é”™è¯¯ > HTTP > 404
validation.required      # éªŒè¯ > å¿…å¡«
```

### 2. å‘½åé£æ ¼

- ä½¿ç”¨å°å†™å­—æ¯å’Œç‚¹å·åˆ†éš”
- ä½¿ç”¨æœ‰æ„ä¹‰çš„åç§°
- ä¿æŒä¸€è‡´æ€§

### 3. å‚æ•°å‘½å

å‚æ•°ä½¿ç”¨å¤§æ‹¬å·åŒ…è£¹ï¼š

```typescript
// ç¿»è¯‘æ–‡æœ¬
'å…± {total} æ¡'
'Total {total} items'

// ä½¿ç”¨
t('common.table.total', { total: 100 })
```

## æœ€ä½³å®è·µ

### 1. é›†ä¸­ç®¡ç†ç¿»è¯‘

å°†æ‰€æœ‰ç¿»è¯‘é›†ä¸­åœ¨ `src/locales` ç›®å½•ä¸‹ï¼Œä¸è¦åœ¨ç»„ä»¶ä¸­ç¡¬ç¼–ç æ–‡æœ¬ã€‚

### 2. ä¿æŒç¿»è¯‘åŒæ­¥

æ·»åŠ æ–°ç¿»è¯‘æ—¶ï¼Œç¡®ä¿æ‰€æœ‰è¯­è¨€éƒ½æœ‰å¯¹åº”çš„ç¿»è¯‘ã€‚

### 3. ä½¿ç”¨å‚æ•°æ›¿æ¢

å¯¹äºåŒ…å«åŠ¨æ€å†…å®¹çš„æ–‡æœ¬ï¼Œä½¿ç”¨å‚æ•°æ›¿æ¢è€Œä¸æ˜¯å­—ç¬¦ä¸²æ‹¼æ¥ï¼š

```typescript
// âŒ ä¸æ¨è
const message = 'å…± ' + total + ' æ¡'

// âœ… æ¨è
const message = t('common.table.total', { total })
```

### 4. æå–å¸¸ç”¨ç¿»è¯‘

å°†å¸¸ç”¨çš„ç¿»è¯‘æå–åˆ° `common` æ¨¡å—ï¼Œé¿å…é‡å¤å®šä¹‰ã€‚

### 5. è¯­ä¹‰åŒ–å‘½å

ä½¿ç”¨è¯­ä¹‰åŒ–çš„ç¿»è¯‘é”®åç§°ï¼Œè®©ä»£ç æ›´æ˜“è¯»ï¼š

```typescript
// âŒ ä¸æ¨è
t('text1')
t('msg2')

// âœ… æ¨è
t('common.action.add')
t('user.message.deleteSuccess')
```

## æ³¨æ„äº‹é¡¹

1. **ç¿»è¯‘ç¼ºå¤±**: å¦‚æœæ‰¾ä¸åˆ°ç¿»è¯‘ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å›é€€åˆ°é»˜è®¤è¯­è¨€ï¼ˆä¸­æ–‡ï¼‰
2. **å‚æ•°æ›¿æ¢**: å‚æ•°åå¿…é¡»ä¸ç¿»è¯‘æ–‡æœ¬ä¸­çš„å ä½ç¬¦åŒ¹é…
3. **Element Plus**: åˆ‡æ¢è¯­è¨€åï¼ŒElement Plus ç»„ä»¶ä¼šè‡ªåŠ¨æ›´æ–°
4. **æŒä¹…åŒ–**: è¯­è¨€è®¾ç½®ä¼šè‡ªåŠ¨ä¿å­˜åˆ° localStorage
5. **æµè§ˆå™¨è¯­è¨€**: é¦–æ¬¡è®¿é—®æ—¶ä¼šè‡ªåŠ¨æ£€æµ‹æµè§ˆå™¨è¯­è¨€

## ç¤ºä¾‹

å®Œæ•´çš„ç¤ºä¾‹è¯·æŸ¥çœ‹ï¼š`src/views/examples/I18nExample.vue`

## ç›¸å…³æ–‡æ¡£

- [Element Plus å›½é™…åŒ–](https://element-plus.org/zh-CN/guide/i18n.html)
- [Vue I18n](https://vue-i18n.intlify.dev/)
