# 接口接口文档

> 统一前缀 `/api`（如启用版本则为 `/api/v1`）；除登录/刷新外默认需要 `Authorization: Bearer <access_token>`。响应：成功 `{ code: 0, message, data }`，失败 `{ code, message }`。分页：`pageNum`(默认1) / `pageSize`(默认10)。

## 用户 / Auth
- 登录 `POST /api/user/login`（无鉴权）  
  Body: `{ username:string, password:string }`  
  Resp.data: `{ token:string, refreshToken:string, userInfo:{ id,username,nickname,roleId,orgId,positionId,avatar,phone,email,gender:0|1|2,birthday, status } }`
- 刷新 `POST /api/user/refresh-token`（无鉴权）  
  Body: `{ refreshToken:string }`  
  Resp.data: `{ token, refreshToken }`
- 登出 `POST /api/user/logout`（鉴权）Body: 空 → Resp.data: null
- 当前用户 `GET /api/user/current`（鉴权）→ Resp.data: userInfo
- 改密 `POST /api/user/change-password`（鉴权）  
  Body: `{ oldPassword:string, newPassword:string }` → Resp.data: null
- 用户列表 `GET /api/user/list`（`user:list`）  
  Query: `pageNum?, pageSize?, username?, roleId?, orgId?, positionId?, status?`  
  Resp.data: `{ total:number, list:[{ id,username,nickname,roleId,orgId,positionId,avatar,phone,email,gender,birthday,status,createdAt }] }`
- 用户详情 `GET /api/user/:id`（`user:detail`）→ Resp.data: userInfo
- 创建用户 `POST /api/user`（`user:create`）  
  Body: `{ username:string, password:string, nickname?:string, roleId?:number, orgId?:number, positionId?:number, avatar?:string, phone?:string, email?:string, gender?:0|1|2, birthday?:string(YYYY-MM-DD), status?:0|1 }`  
  Resp.data: `{ id }`
- 更新用户 `PUT /api/user/:id`（`user:update`）  
  Body: 与创建相同的可选字段（用户名一般不改） → Resp.data: null
- 删除用户 `DELETE /api/user/:id`（`user:delete`）→ Resp.data: null
- 启停用户 `PUT /api/user/:id/status`（`user:update`）  
  Body: `{ status:0|1 }` → Resp.data: null

## 角色
- 列表 `GET /api/role/list`（`role:list`）  
  Query: `pageNum?, pageSize?, roleName?`  
  Resp.data: `{ total, list:[{ id,roleName,roleCode,remark,status,createdAt }] }`
- 详情 `GET /api/role/:id`（`role:detail`）→ Resp.data: `{ id,roleName,roleCode,remark,status,permissionIds:number[] }`
- 创建 `POST /api/role`（`role:create`）  
  Body: `{ roleName:string, roleCode:string, remark?:string, status?:0|1, permissionIds?:number[] }` → Resp.data: `{ id }`
- 更新 `PUT /api/role/:id`（`role:update`）Body 任意上述字段 → Resp.data: null
- 删除 `DELETE /api/role/:id`（`role:delete`）→ Resp.data: null
- 分配权限 `POST /api/role/:id/permissions`（`role:assign`）  
  Body: `{ permissionIds:number[] }` → Resp.data: null

## 权限
- 树 `GET /api/permission/tree`（`permission:list`）→ Resp.data: 树形节点 `{ id,permName,permCode,permType,parentId,path,component,icon,sort,visible,status,children[] }`
- 全部 `GET /api/permission/all`（`permission:list`）→ Resp.data: 权限数组
- 列表 `GET /api/permission/list`（`permission:list`）  
  Query: `pageNum?, pageSize?, permName?, permCode?, permType?`  
  Resp.data: `{ total, list:[{ id,permName,permCode,permType,path,component,icon,sort,visible,status,parentId }] }`
- 详情 `GET /api/permission/:id`（`permission:detail`）→ Resp.data: 同上单条
- 创建 `POST /api/permission`（`permission:create`）  
  Body: `{ permName:string, permCode:string, permType:1|2|3, parentId?:number, path?:string, component?:string, icon?:string, sort?:number, visible?:0|1, status?:0|1 }` → Resp.data:`{ id }`
- 更新 `PUT /api/permission/:id`（`permission:update`）Body 任意上述字段 → Resp.data: null
- 删除 `DELETE /api/permission/:id`（`permission:delete`）→ Resp.data: null

## 菜单
- 树 `GET /api/menu/tree`（`menu:list`）→ Resp.data: 树 `{ id,menuName,menuType,parentId,path,component,icon,sort,visible,status,permCode,redirect,children[] }`
- 当前角色树 `GET /api/menu/tree/current`（鉴权）→ Resp.data: 树
- 列表 `GET /api/menu/list`（`menu:list`）  
  Query: `pageNum?, pageSize?, name?, status?, visible?, parentId?`  
  Resp.data: `{ total, list:[同菜单字段] }`
- 详情 `GET /api/menu/:id`（`menu:detail`）→ Resp.data: 菜单
- 创建 `POST /api/menu`（`menu:create`）  
  Body: `{ menuName:string, menuType:1|2|3, parentId?:number, path?:string, component?:string, icon?:string, sort?:number, visible?:0|1, status?:0|1, permCode?:string, redirect?:string }` → Resp.data:`{ id }`
- 更新 `PUT /api/menu/:id`（`menu:update`）Body 任意上述字段 → Resp.data: null
- 删除 `DELETE /api/menu/:id`（`menu:delete`）→ Resp.data: null

## 机构
- 树 `GET /api/org/tree`（`org:list`）→ Resp.data: 树 `{ id,orgName,orgCode,parentId,sort,status,children[] }`
- 列表 `GET /api/org/list`（`org:list`）  
  Query: `pageNum?, pageSize?, orgName?, orgCode?, status?`  
  Resp.data: `{ total, list:[{ id,orgName,orgCode,parentId,sort,status,createdAt }] }`
- 详情 `GET /api/org/:id`（`org:detail`）→ Resp.data: 机构
- 机构下职位 `GET /api/org/:id/positions`（`org:list`）→ Resp.data: 职位数组
- 创建 `POST /api/org`（`org:create`）  
  Body: `{ orgName:string, orgCode:string, parentId?:number, sort?:number, status?:0|1 }` → Resp.data:`{ id }`
- 更新 `PUT /api/org/:id`（`org:update`）Body 任意上述字段 → Resp.data: null
- 删除 `DELETE /api/org/:id`（`org:delete`）→ Resp.data: null

## 职位
- 列表 `GET /api/position/list`（`position:list`）  
  Query: `pageNum?, pageSize?, positionName?, positionCode?, orgId?, status?`  
  Resp.data: `{ total, list:[{ id,positionName,positionCode,orgId,sort,status,createdAt }] }`
- 详情 `GET /api/position/:id`（`position:detail`）→ Resp.data: 职位
- 创建 `POST /api/position`（`position:create`）  
  Body: `{ positionName:string, positionCode:string, orgId:number, sort?:number, status?:0|1 }` → Resp.data:`{ id }`
- 更新 `PUT /api/position/:id`（`position:update`）Body 任意上述字段 → Resp.data: null
- 删除 `DELETE /api/position/:id`（`position:delete`）→ Resp.data: null

## 字典
- 按类型取值 `GET /api/dict/type/:type`（鉴权）→ Resp.data: `[{ type,label,value,sort,status }]`
- 列表 `GET /api/dict/list`（`dict:list`）  
  Query: `pageNum?, pageSize?, type?, label?, status?`  
  Resp.data: `{ total, list:[{ id,type,label,value,sort,status,remark }] }`
- 详情 `GET /api/dict/:id`（`dict:detail`）→ Resp.data: 字典项
- 创建 `POST /api/dict`（`dict:create`）  
  Body: `{ type:string, label:string, value:string, sort?:number, status?:0|1, remark?:string }` → Resp.data:`{ id }`
- 更新 `PUT /api/dict/:id`（`dict:update`）Body 任意上述字段 → Resp.data: null
- 删除 `DELETE /api/dict/:id`（`dict:delete`）→ Resp.data: null

## 定时任务
- 列表 `GET /api/job/`（`job:list`）→ Resp.data: `[{ name, cron, running:boolean, nextRun:string|null }]`
- 详情 `GET /api/job/:name`（`job:detail`）→ Resp.data: `{ name, cron, running, nextRun }`
- 启动 `POST /api/job/:name/start`（`job:start`）Body: 空 → Resp.data: null
- 停止 `POST /api/job/:name/stop`（`job:stop`）Body: 空 → Resp.data: null

## 文件上传
- 单文件 `POST /api/upload/single`（鉴权，multipart，field=`file`）  
  Resp.data: `{ url, filename, size, mimetype, md5 }`
- 多文件 `POST /api/upload/multiple`（鉴权，multipart，field=`files`，最多10）  
  Resp.data: `{ files: [{ url, filename, size, mimetype, md5 }] }`

## 导入导出
- 导出用户 `GET /api/export/users`（`export:users`）→ 文件流（Excel）
- 导入用户 `POST /api/export/users/import`（`export:import`，multipart `file`）  
  Resp.data: `{ success:number, fail:number, errors?:string[] }`

## 监控
- 指标 `GET /api/monitor/metrics`（`monitor:metrics`）  
  Resp.data: `{ requests:{ total, avgResponseTime, statusCodes:Record<number,number> }, system:{ memoryUsage, uptime, pid }, ... }`

## 其他
- Swagger：`/api-docs`（浏览器访问）
- 探活：`/health`（若开启，无鉴权）

